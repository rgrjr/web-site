<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title>Bob Rogers: Boston Rocks: work flow</title>
</head>

<body bgcolor=white>
<h1>Boston Rocks Web Review:  work flow</h1>

<p><a href="/"><tt>Home</tt></a> : <a href="./">Climbing resources</a> :
Boston Rocks : work flow
<hr>

<a name = db>
<h2>Database</h2>

<a name=people>
<h2>User database</h2>

The <tt>people</tt> table has a <tt>user_class</tt> column that contains
one of the following letters:
<dl compact>
  <dt> <tt>'N'</tt>
  <dd> <b>New</b>, meaning that the user has registered, and we have
       sent the password email, but the user has not yet logged on.
       When the user first logs in, this changes to normal status,
       below.  (This is the only automatic state transition; the other
       classes must be conferred by the Administrator from the command
       line.)  Including this state allows us to detect people who have
       never logged on, which may mean that somebody was trying to sign
       up using somebody else's email address, or a bogus address.
       After a short interval (a few days to a week), we should flush
       such phantom users; this could be done automatically.
  <dt> <tt>'&nbsp;'</tt>
  <dd> <b>Normal</b>, unpriviledged user.  Users can comment on (almost)
       anything, and can see other logged-in users email addresses.
  <dt> <tt>'E'</tt>
  <dd> <b>Editor</b>, who is additionally allowed to change the status
       of comments (see below).
  <dt> <tt>'A'</tt>
  <dd> <b>Administrator</b>, namely the Webmaster.  Administrators can
       do anything (in principal, though in practice the Web interface
       doesn't yet have anything that an administrator can do but an
       editor cannot).
  <dt> <tt>'Z'</tt>
  <dd> <b>Bozoed</b>, meaning that this user is no longer allowed to log
       in.  Comments from bozos are still visible, unless they
       themselves have specifically been bozoed.
</dl>
None of these categories are visible in the user interface, to the user
in question or to other users.  The difference is that certain buttons
on pages may appear or disappear, depending on <tt>user_class</tt>.  For
instance, Joe User may be an editor, but the only way he can tell that
is by the fact that, whenever he is logged in and sees a page with
comments, each comment will have a "click here" button that allows him
to change it's status.  And nobody else (except possibly an
administrator) can discover Joe's user class by browsing the site.

<a name=sections>
<h2>Sections database</h2>

Sections each have a title and a version number, the pair of which must
be distinct.  Except for the topmost section, each section has a parent,
where the parent is a specific version of a section.  Comments also
refer to specific section versions; when a new version of a section is
added to the database, it starts out with no comments, since the old
comments are only pertinent to the old section.

<p>When multiple versions of a section are available, the user interface
will guide users to the latest one, but will also offer to show the
others.  This is necessary to ensure that all comments on the old
version are considered.  [I still need to implement this, but shouldn't
have to worry about it until after the site is up.  -- rgr, 27-Jun-02.]

<p>(Route descriptions likewise have a route name and version
number, and route comments refer to the specific version of the route
description.)

<a name=comments>
<h2>Comments database</h2>

All user-submitted comments have a status letter:
<dl compact>
  <dt> <tt>'N'</tt>
  <dd> <b>New</b>, used when the comment is first added.  New comments
       are shown in red.
  <dt> <tt>'U'</tt>
  <dd> <b>Updated</b>, meaning that the comment has been taken into
       consideration when updating the draft.  (It doesn't necessarily
       mean that the suggested change has been made, only that the
       editor who marked it as updated feels that the matter has been
       taken care of, and it need not be looked at further.)  Updated
       comments are drawn less stridently.  [probably a dark green or
       blue, but i'll decide when i can see them.  -- rgr, 27-Jun-02.]
  <dt> <tt>'Z'</tt>
  <dd> <b>Bozoed</b>, meaning that the comment has been made invisible.
       This should be used only for comments that violate site policy.
       (Even so, we may want to allow people to see these; I dislike
       censorship.)
</dl>
There are two possible transitions: the normal N-to-U updating change,
and the occasional N-to-Z roundfiling.  U-to-N is also supported, in
case somebody has second thoughts.

<h2>Updating procedure</h2>

<ol>
  <li> When the site goes online, it starts collecting comments from
       people.
  <li> Concurrently with this, approved editors can update the
       manuscript and mark comments as having been considered.  New and
       old comments will always be distinguished easily by color.
  <li> At some point, when a new version of the section is ready in
       manuscript, it can be added to the database; all of its
       subsections and routes will be updated at the same time.  The new
       sections/routes start out with no comments.
  <li> The process continues with the updated section(s).  The
       responsible editor must be sure to look at the old version of the
       section, to catch any comments that were added while the new
       version was being put online.
</ol>

This should work reasonably well, regardless of how many editors divide
up the manuscript updating task (as long as they agree on the
divisions).

<p>
<hr>
<address><a href="mailto:rogers@rgrjr.dyndns.org">Bob Rogers
	<tt>&lt;rogers@rgrjr.dyndns.org&gt;</tt></a></address>
<!-- hhmts start -->
Last modified: Thu Jun 27 20:43:41 EDT 2002
<!-- hhmts end -->
</body> </html>
